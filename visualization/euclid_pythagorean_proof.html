<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>유클리드 피타고라스 증명</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --text-color: #2c3e50;
            --square-a: #ff7675;
            --square-b: #74b9ff;
            --square-c: #a29bfe;
        }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg-color); display: flex; flex-direction: column; align-items: center; margin: 0; padding: 20px; }
        .info-panel { text-align: center; margin-bottom: 20px; max-width: 600px; }
        #canvas-svg { background: white; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .controls { margin-top: 20px; }
        button { padding: 10px 25px; font-size: 1rem; cursor: pointer; border: none; border-radius: 5px; background: #2c3e50; color: white; transition: 0.3s; }
        button:hover { background: #34495e; }
        button:disabled { background: #ccc; }
        .step-desc { font-size: 1.1rem; min-height: 3em; color: var(--text-color); margin-top: 10px; }
        .highlight { font-weight: bold; text-decoration: underline; }
    </style>
</head>
<body>

<div class="info-panel">
    <h2>유클리드의 피타고라스 정리 증명</h2>
    <div class="step-desc" id="stepDesc">버튼을 눌러 증명을 시작하세요.</div>
</div>

<svg id="canvas-svg" width="500" height="600" viewBox="0 0 500 600">
    <rect id="sqA" x="120" y="100" width="80" height="80" fill="none" stroke="var(--square-a)" stroke-width="2"/>
    <rect id="sqB" x="200" y="20" width="160" height="160" fill="none" stroke="var(--square-b)" stroke-width="2"/>
    <path id="sqC" d="M200 180 L360 340 L200 500 L40 340 Z" fill="none" stroke="#ddd" stroke-width="2"/>
    <line id="altitude" x1="200" y1="180" x2="200" y2="500" stroke="#ccc" stroke-dasharray="5,5" opacity="0"/>
    <polygon id="movingTri" points="120,180 200,180 120,100" fill="var(--square-a)" opacity="0.5"/>
    <polygon id="mainTri" points="120,180 200,180 200,20" fill="#333"/>
    <text x="110" y="195" font-size="14">C</text>
    <text x="210" y="195" font-size="14">A</text>
    <text x="210" y="15" font-size="14">B</text>
</svg>

<div class="controls">
    <button id="prevBtn" onclick="changeStep(-1)">이전</button>
    <button id="nextBtn" onclick="changeStep(1)">다음 단계</button>
</div>

<script>
    let step = 0;
    const desc = document.getElementById('stepDesc');
    const nextBtn = document.getElementById('nextBtn');
    const movingTri = document.getElementById('movingTri');

    let currentPoints = [120, 180, 200, 180, 120, 100];

    function setPoints(arr) {
        const pairs = [];
        for (let i = 0; i < arr.length; i += 2) {
            pairs.push(`${arr[i]},${arr[i + 1]}`);
        }
        movingTri.setAttribute('points', pairs.join(' '));
    }

    function tweenPoints(target, duration = 1.5) {
        gsap.killTweensOf(movingTri);
        if (target.length !== currentPoints.length) {
            currentPoints = target.slice();
            setPoints(currentPoints);
            return;
        }

        const state = { t: 0 };
        const start = currentPoints.slice();
        gsap.to(state, {
            t: 1,
            duration,
            ease: 'power1.inOut',
            onUpdate: () => {
                const next = start.map((v, i) => v + (target[i] - v) * state.t);
                setPoints(next);
            },
            onComplete: () => {
                currentPoints = target.slice();
                setPoints(currentPoints);
            }
        });
    }

    const steps = [
        {
            text: "직각삼각형 ABC가 있습니다. 각 변을 한 변으로 하는 <span style='color:var(--square-a)'>정사각형</span>들을 그립니다.",
            action: () => {
                tweenPoints([120, 180, 200, 180, 120, 100], 0.8);
                gsap.to("#sqA, #sqB", { opacity: 1, duration: 0.6 });
                gsap.to("#sqC", { stroke: "#333", duration: 1 });
                gsap.to("#movingTri", { opacity: 0, duration: 0.4 });
                gsap.to("#altitude", { opacity: 0, duration: 0.4 });
            }
        },
        {
            text: "꼭짓점 A에서 빗변에 수선을 내립니다. 이 선은 큰 사각형을 <span class='highlight'>두 개의 직사각형</span>으로 나눕니다.",
            action: () => {
                tweenPoints([120, 180, 200, 180, 120, 100], 0.8);
                gsap.to("#altitude", { opacity: 1, duration: 1 });
                gsap.to("#movingTri", { opacity: 0.6, fill: "var(--square-a)", duration: 0.8 });
            }
        },
        {
            text: "이제 <span class='highlight'>등적변형</span>을 시작합니다. 밑변(AC)과 높이가 같으므로 왼쪽 사각형 절반의 넓이는 이 삼각형과 같습니다.",
            action: () => {
                tweenPoints([120, 180, 200, 180, 40, 340], 1.5);
            }
        },
        {
            text: "이 삼각형을 꼭짓점 C를 중심으로 90도 회전시킵니다. 그러면 <span class='highlight'>합동</span>인 삼각형이 됩니다.",
            action: () => {
                tweenPoints([120, 180, 40, 340, 200, 500], 1.5);
            }
        },
        {
            text: "다시 등적변형을 하면, 이 넓이는 아래쪽 <span class='highlight'>직사각형 넓이의 절반</span>과 같음을 알 수 있습니다.",
            action: () => {
                tweenPoints([120, 180, 200, 500, 200, 180], 1.5);
            }
        },
        {
            text: "결국 왼쪽 정사각형의 넓이는 아래쪽 왼쪽 직사각형의 넓이와 같습니다. 오른쪽도 같은 방법으로 증명됩니다!",
            action: () => {
                gsap.to("#sqA", { fill: "var(--square-a)", opacity: 0.3, duration: 1 });
                currentPoints = [120, 180, 40, 340, 200, 500, 200, 180];
                setPoints(currentPoints);
                gsap.to("#movingTri", { fill: "var(--square-a)", opacity: 0.5, duration: 1 });
            }
        }
    ];

    function changeStep(dir) {
        step += dir;
        if (step < 0) step = 0;
        if (step >= steps.length) {
            step = 0;
        }

        desc.innerHTML = steps[step].text;
        steps[step].action();

        document.getElementById('prevBtn').disabled = (step === 0);
        nextBtn.innerText = (step === steps.length - 1) ? "다시 시작" : "다음 단계";
    }

    changeStep(0);
</script>

</body>
</html>
